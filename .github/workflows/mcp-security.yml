name: MCP Security Scan
"on":
  pull_request:
    branches: [main]

jobs:
  security-scan:
    runs-on: ubuntu-latest
    permissions:
      checks: write
      pull-requests: write
    steps:
      - uses: iceysteel/mcp-lockdown-github-action@main
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          api-key: ${{ secrets.MCP_LOCKDOWN_API_KEY }}
          techniques: owasp-top-10
          fail-on-findings: true
